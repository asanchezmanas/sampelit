<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sampelit | Billing</title>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Manrope:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1" />

    <!-- Core Design System: Tailwind CDN + Style Standard -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
    <link rel="stylesheet" href="css/sampelit-v2.css" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: "#0f172a",   // Navy Sampelit
                        accent: "#1e3a8a",    // Blue Accent Premium
                        sampelit: "#0f172a"   // Alias primary
                    },
                    fontFamily: {
                        display: ['Manrope', 'sans-serif'],
                        body: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'premium': '0 10px 30px -5px rgba(15, 23, 42, 0.08)',
                        'soft': '0 2px 10px rgba(0, 0, 0, 0.03)'
                    }
                }
            }
        }
    </script>

    <style>
        [x-cloak] {
            display: none !important;
        }
    </style>

    <!-- Essential Scripts -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="js/core/api.js"></script>
    <script src="js/include.js"></script>
</head>

<body x-data="billingController"
    class="bg-[#f8f9fc] dark:bg-gray-900 text-text-main dark:text-gray-300 font-sans antialiased">
    <div class="flex h-screen overflow-hidden">
        <include src="./partials/sidebar_v2.html"></include>

        <div class="relative flex flex-1 flex-col overflow-y-auto overflow-x-hidden">
            <include src="./partials/header_v2.html"></include>

            <main>
                <div class="mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10">
                    <!-- Page Header -->
                    <div class="mb-10 flex flex-col gap-6 md:flex-row md:items-end md:justify-between">
                        <div>
                            <nav
                                class="mb-2 flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-gray-400 dark:text-gray-500">
                                <a href="index_v2.html" class="hover:text-brand-500 transition-colors">Command
                                    Center</a>
                                <span class="material-symbols-outlined text-[10px]">chevron_right</span>
                                <span class="text-gray-900 dark:text-white">Capital Management</span>
                            </nav>
                            <h1
                                class="text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white font-display">
                                Billing
                            </h1>
                            <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                                Manage your subscriptions, payment methods, and transaction history.
                            </p>
                        </div>
                        <div class="flex items-center gap-3">
                            <button @click="contactSupport"
                                class="rounded-xl border border-gray-200 bg-white px-5 py-2.5 text-xs font-bold text-gray-700 shadow-soft hover:bg-gray-50 transition-all dark:border-white/5 dark:bg-white/5 dark:text-white">
                                Contact Support
                            </button>
                            <button @click="upgradePlan"
                                class="rounded-xl bg-gray-900 px-5 py-2.5 text-xs font-bold text-white shadow-premium hover:bg-black transition-all">
                                Upgrade Plan
                            </button>
                        </div>
                    </div>

                    <!-- Usage & Plan Cards -->
                    <div class="grid grid-cols-1 gap-6 lg:grid-cols-3 mb-10">
                        <div
                            class="lg:col-span-2 overflow-hidden rounded-[40px] border border-gray-100 bg-white p-10 shadow-premium dark:border-white/5 dark:bg-white/[0.03] relative group">
                            <!-- Premium Glow Effect -->
                            <div
                                class="absolute -top-24 -right-24 h-64 w-64 bg-sampelit/5 rounded-full blur-3xl group-hover:bg-sampelit/10 transition-colors duration-700">
                            </div>

                            <div class="absolute top-10 right-10">
                                <span
                                    class="inline-flex items-center gap-2 rounded-full bg-emerald-50 px-4 py-2 text-[10px] font-black uppercase tracking-widest text-emerald-600 dark:bg-emerald-500/10 dark:text-emerald-400 border border-emerald-100 dark:border-emerald-500/20">
                                    <span class="relative flex h-2 w-2">
                                        <span
                                            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                        <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                                    </span>
                                    Live Subscription
                                </span>
                            </div>

                            <div class="flex items-start gap-8 mb-12">
                                <div
                                    class="flex h-20 w-20 shrink-0 items-center justify-center rounded-[24px] bg-gray-50 text-sampelit border border-gray-100 shadow-theme-sm dark:bg-white/5 dark:border-white/5 dark:text-white group-hover:scale-110 transition-transform duration-500">
                                    <span class="material-symbols-outlined text-4xl"
                                        x-text="subscription.plan_name === 'Business Pro' ? 'rocket_launch' : 'rocket'"></span>
                                </div>
                                <div x-show="!loading" class="pt-2">
                                    <p
                                        class="text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 flex items-center gap-2">
                                        Active Tier
                                        <span class="h-1 w-1 rounded-full bg-gray-300"></span>
                                        <span
                                            x-text="subscription.plan_name === 'Business Pro' ? 'Power User' : 'Standard'"></span>
                                    </p>
                                    <h3 class="text-4xl font-black text-gray-900 dark:text-white font-display leading-none"
                                        x-text="subscription.plan_name">Business Pro</h3>
                                    <p
                                        class="mt-4 text-sm text-gray-500 dark:text-gray-400 font-medium leading-relaxed">
                                        Renewing on <span class="font-black text-gray-900 dark:text-white"
                                            x-text="subscription.renewal_date">Oct 24, 2025</span>
                                    </p>
                                </div>
                                <div x-show="loading" class="animate-pulse flex flex-col gap-4 pt-4">
                                    <div class="h-4 w-24 bg-gray-100 dark:bg-white/5 rounded-full"></div>
                                    <div class="h-10 w-64 bg-gray-100 dark:bg-white/5 rounded-2xl"></div>
                                </div>
                            </div>

                            <div
                                class="grid gap-10 sm:grid-cols-2 mt-12 pt-10 border-t border-gray-50 dark:border-white/5">
                                <div class="space-y-4">
                                    <div class="flex justify-between items-end">
                                        <div class="flex flex-col gap-1">
                                            <span
                                                class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Growth
                                                Volume (MAU)</span>
                                            <p class="text-xs text-gray-500 font-medium italic">Monthly unique instances
                                                tracked</p>
                                        </div>
                                        <span class="text-sm font-black text-gray-900 dark:text-white font-display"
                                            x-text="loading ? '...' : `${subscription.usage.mau.current / 1000}k / ${subscription.usage.mau.limit / 1000}k`"></span>
                                    </div>
                                    <div
                                        class="h-3 w-full rounded-full bg-gray-50 dark:bg-white/5 overflow-hidden border border-gray-100 dark:border-white/10">
                                        <div class="h-full bg-sampelit dark:bg-white transition-all duration-1000 ease-out"
                                            :style="`width: ${loading ? 0 : subscription.usage.mau.percent}%`"></div>
                                    </div>
                                </div>
                                <div class="space-y-4">
                                    <div class="flex justify-between items-end">
                                        <div class="flex flex-col gap-1">
                                            <span
                                                class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Active
                                                Discoveries</span>
                                            <p class="text-xs text-gray-500 font-medium italic">Parallel live
                                                optimizations</p>
                                        </div>
                                        <span class="text-sm font-black text-gray-900 dark:text-white font-display"
                                            x-text="loading ? '...' : `${subscription.usage.experiments.current} / ${subscription.usage.experiments.limit}`"></span>
                                    </div>
                                    <div
                                        class="h-3 w-full rounded-full bg-gray-50 dark:bg-white/5 overflow-hidden border border-gray-100 dark:border-white/10">
                                        <div class="h-full bg-accent dark:bg-brand-400 transition-all duration-1000 ease-out shadow-[0_0_15px_rgba(30,58,138,0.3)]"
                                            :style="`width: ${loading ? 0 : subscription.usage.experiments.percent}%`">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Method Card -->
                        <div
                            class="overflow-hidden rounded-[40px] border border-gray-100 bg-white p-10 shadow-premium dark:border-white/5 dark:bg-white/[0.03] flex flex-col justify-between">
                            <div>
                                <div class="flex justify-between items-start mb-10">
                                    <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Capital
                                        Source</p>
                                    <button
                                        class="h-10 w-10 flex items-center justify-center rounded-xl bg-gray-50 text-gray-400 hover:text-sampelit transition-all dark:bg-white/5">
                                        <span class="material-symbols-outlined text-xl">edit</span>
                                    </button>
                                </div>

                                <div class="flex items-center gap-5 mb-8">
                                    <div
                                        class="flex h-12 w-20 items-center justify-center rounded-xl border border-gray-100 bg-gray-50 dark:bg-white/5 dark:border-white/5">
                                        <span
                                            class="material-symbols-outlined text-3xl text-gray-400">credit_card</span>
                                    </div>
                                    <div x-show="!loading">
                                        <p
                                            class="text-sm font-black text-gray-900 dark:text-white flex items-center gap-2">
                                            <span x-text="subscription.payment_method.type">Visa</span>
                                            <span class="h-1 w-1 rounded-full bg-gray-300"></span>
                                            •••• <span x-text="subscription.payment_method.last4">4242</span>
                                        </p>
                                        <p class="text-[10px] text-gray-400 uppercase font-black tracking-widest mt-1">
                                            Exp. <span x-text="subscription.payment_method.expiry">12/25</span></p>
                                    </div>
                                </div>

                                <div class="space-y-2 py-6 border-t border-gray-50 dark:border-white/5"
                                    x-show="!loading">
                                    <p class="text-xs font-black text-gray-900 dark:text-white uppercase tracking-widest"
                                        x-text="subscription.payment_method.holder">Alex Morgan</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 font-medium leading-relaxed"
                                        x-text="subscription.payment_method.billing_address">Bahnhofstrasse 12, Zurich.
                                    </p>
                                </div>
                            </div>

                            <div class="pt-6">
                                <button
                                    class="w-full h-12 rounded-2xl bg-gray-50 text-[10px] font-black uppercase tracking-widest text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all dark:bg-white/5 dark:text-gray-400">
                                    Management Portal
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Transaction History -->
                    <div class="mb-10">
                        <div class="flex flex-col md:flex-row items-center justify-between mb-8 px-2 gap-4">
                            <div class="flex flex-col gap-1">
                                <h2 class="text-2xl font-black text-gray-900 dark:text-white font-display">Capital
                                    Transaction History</h2>
                                <p class="text-xs text-gray-400 font-medium">Review and export your financial directives
                                    over the last 12 months.</p>
                            </div>
                            <div class="flex gap-3">
                                <div class="relative">
                                    <select
                                        class="h-12 appearance-none pl-6 pr-12 rounded-2xl border border-gray-100 dark:border-white/5 bg-white dark:bg-[#111621] text-[10px] font-black uppercase tracking-widest text-gray-500 dark:text-gray-300 focus:outline-none focus:ring-4 focus:ring-brand-500/10 cursor-pointer">
                                        <option>Last 12 Months</option>
                                        <option>All Time</option>
                                    </select>
                                    <div
                                        class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-gray-400">
                                        <span class="material-symbols-outlined text-xl">expand_more</span>
                                    </div>
                                </div>
                                <button
                                    class="h-12 px-6 rounded-2xl bg-gray-900 text-[10px] font-black uppercase tracking-widest text-white hover:bg-black transition-all shadow-premium flex items-center gap-2">
                                    <span class="material-symbols-outlined text-sm">download</span>
                                    Export CSV
                                </button>
                            </div>
                        </div>

                        <div
                            class="overflow-hidden rounded-[40px] border border-gray-100 bg-white shadow-premium dark:border-white/5 dark:bg-white/[0.03]">
                            <div class="overflow-x-auto">
                                <table class="w-full text-left border-collapse">
                                    <thead>
                                        <tr
                                            class="bg-gray-50/50 dark:bg-white/[0.01] border-b border-gray-100 dark:border-white/5 text-[10px] font-black uppercase tracking-widest text-gray-400">
                                            <th class="px-8 py-6">Statement ID</th>
                                            <th class="px-8 py-6">Issue Date</th>
                                            <th class="px-8 py-6">Capital Flow</th>
                                            <th class="px-8 py-6 text-center">Service Tier</th>
                                            <th class="px-8 py-6 text-center">Protocol</th>
                                            <th class="px-8 py-6 text-right">Directives</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-50 dark:divide-white/5">
                                        <template x-for="invoice in invoices" :key="invoice.id">
                                            <tr
                                                class="group hover:bg-gray-50/50 dark:hover:bg-white/[0.01] transition-all duration-300">
                                                <td class="px-8 py-6">
                                                    <div class="flex items-center gap-4">
                                                        <div
                                                            class="flex h-10 w-10 items-center justify-center rounded-xl bg-white border border-gray-100 shadow-theme-sm dark:bg-gray-800 dark:border-white/5 text-gray-400 group-hover:text-sampelit transition-colors">
                                                            <span
                                                                class="material-symbols-outlined text-xl">description</span>
                                                        </div>
                                                        <span class="text-sm font-black text-gray-900 dark:text-white"
                                                            x-text="invoice.id"></span>
                                                    </div>
                                                </td>
                                                <td class="px-8 py-6">
                                                    <span class="text-xs font-bold text-gray-500 dark:text-gray-400"
                                                        x-text="invoice.date"></span>
                                                </td>
                                                <td class="px-8 py-6">
                                                    <span class="text-sm font-black text-gray-900 dark:text-white"
                                                        x-text="invoice.amount"></span>
                                                </td>
                                                <td class="px-8 py-6 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest"
                                                    x-text="invoice.plan"></td>
                                                <td class="px-8 py-6 text-center">
                                                    <span
                                                        class="inline-flex items-center px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest transition-all"
                                                        :class="invoice.status === 'paid' ? 'bg-emerald-50 text-emerald-600 dark:bg-emerald-500/10 dark:text-emerald-400 border border-emerald-100/50' : 'bg-gray-100 text-gray-500 dark:bg-white/5'"
                                                        x-text="invoice.status">
                                                    </span>
                                                </td>
                                                <td class="px-8 py-6 text-right">
                                                    <button @click="downloadInvoice(invoice.id)"
                                                        class="h-10 w-10 flex items-center justify-center rounded-xl bg-gray-50 text-gray-400 hover:bg-sampelit hover:text-white transition-all dark:bg-white/5">
                                                        <span class="material-symbols-outlined text-xl">download</span>
                                                    </button>
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Enterprise Section -->
                    <div class="rounded-[40px] bg-sampelit p-12 text-white relative overflow-hidden shadow-2xl">
                        <div class="absolute inset-0 bg-gradient-to-br from-brand-500/30 via-transparent to-accent/30">
                        </div>
                        <div class="absolute -bottom-24 -left-24 h-64 w-64 bg-white/5 rounded-full blur-3xl"></div>

                        <div class="relative z-10 flex flex-col lg:flex-row items-center justify-between gap-12">
                            <div class="max-w-2xl text-center lg:text-left">
                                <div
                                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 text-[10px] font-black uppercase tracking-widest mb-6">
                                    <span class="material-symbols-outlined text-sm">verified</span>
                                    Custom Protocol
                                </div>
                                <h4 class="text-4xl font-black font-display leading-tight">Scale Without Limits with
                                    Enterprise Directives.</h4>
                                <p class="mt-4 text-lg text-gray-300 font-medium leading-relaxed">
                                    Tailored SLAs, dedicated support engineers, and infinite traffic auditing for
                                    decentralized global teams.
                                </p>
                            </div>
                            <button
                                class="flex h-16 items-center gap-4 rounded-3xl bg-white px-10 text-[10px] font-black uppercase tracking-widest text-sampelit hover:bg-gray-100 hover:scale-105 transition-all shadow-xl group">
                                Initiate Enterprise Dialogue
                                <span
                                    class="material-symbols-outlined text-xl group-hover:translate-x-1 transition-transform">arrow_forward</span>
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Premium Upgrade Modal (TailAdmin Flow) -->
    <div x-show="showUpgradeModal" x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0" class="fixed inset-0 z-999 flex items-center justify-center p-4 sm:p-6"
        x-cloak>

        <!-- Backdrop with Blur -->
        <div class="absolute inset-0 bg-gray-900/40 backdrop-blur-xl transition-all" @click="showUpgradeModal = false">
        </div>

        <!-- Modal Content -->
        <div x-show="showUpgradeModal" x-transition:enter="transition ease-out duration-500"
            x-transition:enter-start="opacity-0 scale-95 translate-y-4"
            x-transition:enter-end="opacity-100 scale-100 translate-y-0"
            x-transition:leave="transition ease-in duration-300"
            x-transition:leave-start="opacity-100 scale-100 translate-y-0"
            x-transition:leave-end="opacity-0 scale-95 translate-y-4"
            class="relative w-full max-w-6xl overflow-hidden rounded-[48px] bg-[#f8f9fc] dark:bg-[#111621] shadow-2xl border border-white/20">

            <!-- Close Button -->
            <button @click="showUpgradeModal = false"
                class="absolute top-8 right-8 z-20 h-10 w-10 flex items-center justify-center rounded-full bg-white/10 text-gray-500 hover:bg-white hover:text-sampelit transition-all shadow-sm">
                <span class="material-symbols-outlined">close</span>
            </button>

            <div class="p-12 sm:p-16">
                <!-- Modal Header -->
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-black text-gray-900 dark:text-white font-display mb-4">Elevate Your
                        Discovery Capacity</h2>
                    <p class="text-sm text-gray-500 font-medium max-w-lg mx-auto">Choose the protocol that aligns with
                        your organization's growth velocity.</p>

                    <!-- Billing Cycle Toggle -->
                    <div
                        class="mt-10 inline-flex items-center p-1.5 bg-gray-100 dark:bg-white/5 rounded-2xl border border-gray-200 dark:border-white/5">
                        <button @click="billingCycle = 'monthly'"
                            :class="billingCycle === 'monthly' ? 'bg-white dark:bg-white/10 text-gray-900 dark:text-white shadow-sm' : 'text-gray-400 hover:text-gray-600'"
                            class="px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all">Monthly
                            Flow</button>
                        <button @click="billingCycle = 'yearly'"
                            :class="billingCycle === 'yearly' ? 'bg-white dark:bg-white/10 text-gray-900 dark:text-white shadow-sm' : 'text-gray-400 hover:text-gray-600'"
                            class="px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2">
                            Yearly Output
                            <span class="px-2 py-0.5 rounded-full bg-emerald-500 text-[8px] text-white">Save 20%</span>
                        </button>
                    </div>
                </div>

                <!-- Pricing Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <template x-for="plan in pricingPlans" :key="plan.name">
                        <div class="relative flex flex-col p-10 rounded-[36px] transition-all duration-500 group"
                            :class="plan.current ? 'bg-sampelit text-white shadow-2xl scale-105 z-10' : 'bg-white dark:bg-white/5 text-gray-900 dark:text-white border border-gray-100 dark:border-white/5 hover:border-sampelit/20'">

                            <div x-show="plan.current"
                                class="absolute -top-4 left-1/2 -translate-x-1/2 px-4 py-1.5 bg-brand-500 text-[10px] font-black uppercase tracking-widest rounded-full shadow-lg">
                                Current Protocol</div>

                            <div class="flex items-center gap-4 mb-8">
                                <div class="flex h-12 w-12 items-center justify-center rounded-2xl"
                                    :class="plan.current ? 'bg-white/10' : 'bg-gray-50 dark:bg-white/5'">
                                    <span class="material-symbols-outlined text-2xl" x-text="plan.icon"></span>
                                </div>
                                <h3 class="text-xl font-black font-display" x-text="plan.name"></h3>
                            </div>

                            <div class="mb-8">
                                <div class="flex items-baseline gap-1">
                                    <span class="text-4xl font-black font-display"
                                        x-text="plan.price[billingCycle] === 'Custom' ? 'Custom' : '€' + plan.price[billingCycle]"></span>
                                    <span class="text-sm font-bold opacity-60"
                                        x-show="plan.price[billingCycle] !== 'Custom'">/monthly</span>
                                </div>
                                <p class="mt-3 text-xs opacity-70 font-medium leading-relaxed"
                                    x-text="plan.description"></p>
                            </div>

                            <div class="flex-1 space-y-4 mb-10">
                                <template x-for="feature in plan.features" :key="feature">
                                    <div class="flex items-center gap-3">
                                        <span class="material-symbols-outlined text-lg"
                                            :class="plan.current ? 'text-brand-400' : 'text-emerald-500'">check_circle</span>
                                        <span class="text-xs font-bold" x-text="feature"></span>
                                    </div>
                                </template>
                            </div>

                            <button @click="switchPlan(plan.name)" :disabled="plan.current"
                                class="w-full h-14 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all border"
                                :class="plan.current ? 'bg-white/10 border-white/20 text-white cursor-default' : 'bg-gray-900 dark:bg-white text-white dark:text-sampelit border-transparent hover:scale-105 shadow-xl'">
                                <span
                                    x-text="plan.current ? 'Current Active' : (plan.name === 'Enterprise' ? 'Contact Sales' : 'Select Protocol')"></span>
                            </button>
                        </div>
                    </template>
                </div>

                <p class="text-center mt-12 text-[10px] text-gray-400 uppercase font-bold tracking-widest">Secure
                    checkout via Stripe. Cancel any time with 30-day data retention.</p>
            </div>
        </div>
    </div>
    </div>
    </main>
    </div>
    </div>

    <!-- Page Script -->
    <script src="js/pages/billing_v2.js"></script>
</body>

</html>