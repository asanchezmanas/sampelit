<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sampelit | New Experiment</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;family=Manrope:wght@300;400;500;600;700;800&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        "primary": "#1E3A8A", // Dark Navy
                        "primary-dark": "#0f172a",
                        "primary-light": "#eff4ff",
                        "background-light": "#f8f9fc",
                        "background-dark": "#111621",
                        "surface": "#ffffff",
                        "text-main": "#0f172a",
                        "text-secondary": "#64748b",
                        "border-subtle": "#e2e8f0",
                        // Aliases for compatibility with source files
                        "navy-accent": "#1e293b",
                        "success": "#10b981",
                        "warning": "#f59e0b",
                        gray: {
                            50: '#F9FAFB', 100: '#F3F4F6', 200: '#E5E7EB', 300: '#D1D5DB',
                            400: '#9CA3AF', 500: '#6B7280', 600: '#4B5563', 700: '#374151',
                            800: '#1F2937', 900: '#111827'
                        }
                    },
                    fontFamily: {
                        display: ['Manrope', 'sans-serif'],
                        sans: ['Manrope', 'sans-serif'],
                        body: ['Inter', 'sans-serif']
                    },
                    boxShadow: {
                        'soft': '0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02)',
                        'elegant': '0 10px 15px -3px rgba(0, 0, 0, 0.03), 0 4px 6px -2px rgba(0, 0, 0, 0.01)',
                        'float': '0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02)',
                    }
                },
            },
        };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="js/core/api.js"></script>
    <script src="js/include.js"></script>
</head>

<body x-data="experimentWizard()" x-init="init()" :class="{ 'dark': darkMode === true }"
    class="bg-[#f8f9fc] dark:bg-gray-900 text-text-main dark:text-gray-300 font-sans antialiased selection:bg-primary/10 selection:text-primary">

    <div class="flex h-screen overflow-hidden">
        <!-- App Sidebar -->
        <include src="./partials/sidebar_v2.html"></include>

        <!-- Content Area -->
        <div
            class="relative flex flex-1 flex-col overflow-hidden bg-surface dark:bg-gray-900 transition-colors duration-300">
            <!-- App Header -->
            <include src="./partials/header_v2.html"></include>

            <!-- Main Scrollable Area -->
            <main class="flex-1 flex overflow-hidden">
                <div class="flex flex-1 max-w-[1600px] mx-auto w-full h-full">

                    <!-- Wizard Sidebar (Left) -->
                    <aside
                        class="w-72 hidden xl:flex flex-col border-r border-border-subtle bg-white dark:bg-gray-800 dark:border-gray-700 pt-8 px-6 h-full overflow-y-auto z-10">
                        <div class="flex flex-col gap-1 mb-10">
                            <a class="text-text-secondary dark:text-gray-400 hover:text-primary flex items-center gap-2 text-sm font-medium leading-normal mb-4 transition-colors"
                                href="experiments_v2.html">
                                <span class="material-symbols-outlined text-[18px]">arrow_back</span>
                                Back to Experiments
                            </a>
                            <p
                                class="text-text-secondary text-xs uppercase tracking-wider font-semibold dark:text-gray-500">
                                Progress</p>
                        </div>

                        <!-- Progress Steps -->
                        <div class="flex flex-col relative h-[400px]">
                            <!-- Step 1 -->
                            <div class="flex gap-4 group cursor-pointer" @click="step = 1">
                                <div class="flex flex-col items-center">
                                    <div class="flex items-center justify-center size-8 rounded-full transition-all"
                                        :class="step === 1 ? 'bg-primary text-white shadow-md ring-4 ring-primary/10' : (step > 1 ? 'bg-green-500 text-white' : 'bg-white border border-border-subtle text-text-secondary dark:bg-gray-700 dark:border-gray-600')">
                                        <span class="material-symbols-outlined text-[18px]"
                                            x-text="step > 1 ? 'check' : 'edit_note'"></span>
                                    </div>
                                    <div class="w-px h-full bg-border-subtle dark:bg-gray-700 my-2 group-last:hidden">
                                    </div>
                                </div>
                                <div class="pb-10 pt-1">
                                    <p class="text-sm font-bold transition-colors"
                                        :class="step === 1 ? 'text-primary' : 'text-text-main dark:text-gray-200'">1.
                                        Define Hypothesis</p>
                                    <p class="text-xs mt-1 text-text-secondary dark:text-gray-500">Goal setting &
                                        description</p>
                                </div>
                            </div>

                            <!-- Step 2 -->
                            <div class="flex gap-4 group cursor-pointer" @click="step > 1 ? step = 2 : null">
                                <div class="flex flex-col items-center">
                                    <div class="flex items-center justify-center size-8 rounded-full transition-all"
                                        :class="step === 2 ? 'bg-primary text-white shadow-md ring-4 ring-primary/10' : (step > 2 ? 'bg-green-500 text-white' : 'bg-white border border-border-subtle text-text-secondary dark:bg-gray-700 dark:border-gray-600')">
                                        <span class="material-symbols-outlined text-[18px]"
                                            x-text="step > 2 ? 'check' : 'group'"></span>
                                    </div>
                                    <div class="w-px h-full bg-border-subtle dark:bg-gray-700 my-2 group-last:hidden">
                                    </div>
                                </div>
                                <div class="pb-10 pt-1">
                                    <p class="text-sm font-bold transition-colors"
                                        :class="step === 2 ? 'text-primary' : 'text-text-main dark:text-gray-200'">2.
                                        Audience</p>
                                    <p class="text-xs mt-1 text-text-secondary dark:text-gray-500">Targeting &
                                        allocation</p>
                                </div>
                            </div>

                            <!-- Step 3 -->
                            <div class="flex gap-4 group cursor-pointer" @click="step > 2 ? step = 3 : null">
                                <div class="flex flex-col items-center">
                                    <div class="flex items-center justify-center size-8 rounded-full transition-all"
                                        :class="step === 3 ? 'bg-primary text-white shadow-md ring-4 ring-primary/10' : (step > 3 ? 'bg-green-500 text-white' : 'bg-white border border-border-subtle text-text-secondary dark:bg-gray-700 dark:border-gray-600')">
                                        <span class="material-symbols-outlined text-[18px]"
                                            x-text="step > 3 ? 'check' : 'layers'"></span>
                                    </div>
                                    <div class="w-px h-full bg-border-subtle dark:bg-gray-700 my-2 group-last:hidden">
                                    </div>
                                </div>
                                <div class="pb-10 pt-1">
                                    <p class="text-sm font-bold transition-colors"
                                        :class="step === 3 ? 'text-primary' : 'text-text-main dark:text-gray-200'">3.
                                        Variations</p>
                                    <p class="text-xs mt-1 text-text-secondary dark:text-gray-500">Design changes</p>
                                </div>
                            </div>

                            <!-- Step 4 -->
                            <div class="flex gap-4 group cursor-pointer" @click="step > 3 ? step = 4 : null">
                                <div class="flex flex-col items-center">
                                    <div class="flex items-center justify-center size-8 rounded-full transition-all"
                                        :class="step === 4 ? 'bg-primary text-white shadow-md ring-4 ring-primary/10' : 'bg-white border border-border-subtle text-text-secondary dark:bg-gray-700 dark:border-gray-600'">
                                        <span class="material-symbols-outlined text-[18px]">rocket_launch</span>
                                    </div>
                                </div>
                                <div class="pb-10 pt-1">
                                    <p class="text-sm font-bold transition-colors"
                                        :class="step === 4 ? 'text-primary' : 'text-text-main dark:text-gray-200'">4.
                                        Review & Launch</p>
                                    <p class="text-xs mt-1 text-text-secondary dark:text-gray-500">Final check</p>
                                </div>
                            </div>
                        </div>
                    </aside>

                    <!-- Main Form Content -->
                    <div
                        class="flex-1 flex flex-col min-h-0 bg-background-subtle dark:bg-gray-900 overflow-y-auto relative">

                        <!-- Mobile Header -->
                        <div
                            class="xl:hidden px-6 py-4 border-b border-border-subtle bg-white dark:bg-gray-800 dark:border-gray-700">
                            <div class="flex items-center gap-2 text-sm text-text-secondary dark:text-gray-400">
                                <span>Step <span x-text="step"></span> of 4</span>
                                <span class="material-symbols-outlined text-[14px]">chevron_right</span>
                                <span class="font-bold text-text-main dark:text-white"
                                    x-text="step === 1 ? 'Hypothesis' : (step === 2 ? 'Audience' : (step === 3 ? 'Variations' : 'Review'))"></span>
                            </div>
                        </div>

                        <!-- Step 1 Content: Define Hypothesis -->
                        <div x-show="step === 1"
                            class="flex-1 px-6 lg:px-12 py-10 max-w-4xl mx-auto w-full transition-opacity duration-300">
                            <div class="mb-10">
                                <h1
                                    class="text-3xl lg:text-4xl font-bold tracking-tight mb-2 text-text-main dark:text-white">
                                    Define your Hypothesis</h1>
                                <p class="text-text-secondary text-lg dark:text-gray-400">Start by establishing what you
                                    want to achieve and why.</p>
                            </div>
                            <form class="space-y-8">
                                <div
                                    class="bg-white p-8 rounded-xl border border-border-subtle shadow-subtle dark:bg-gray-800 dark:border-gray-700">
                                    <div class="grid gap-6">
                                        <div class="grid gap-2">
                                            <label
                                                class="text-sm font-semibold text-text-main dark:text-gray-200">Experiment
                                                Name</label>
                                            <input x-model="experiment.name"
                                                class="w-full rounded-lg border-border-subtle bg-background-subtle px-4 py-3 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all dark:bg-gray-900 dark:border-gray-600 dark:text-white"
                                                placeholder="e.g., Homepage Hero CTA Redesign" type="text" />
                                        </div>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div class="grid gap-2">
                                                <label
                                                    class="text-sm font-semibold text-text-main dark:text-gray-200">Target
                                                    Page URL</label>
                                                <div class="relative">
                                                    <span
                                                        class="absolute left-4 top-3 text-text-secondary/50 material-symbols-outlined text-[20px]">link</span>
                                                    <input x-model="experiment.url"
                                                        class="w-full rounded-lg border-border-subtle bg-background-subtle pl-11 pr-4 py-3 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all dark:bg-gray-900 dark:border-gray-600 dark:text-white"
                                                        type="url" />
                                                </div>
                                            </div>
                                            <div class="grid gap-2">
                                                <label
                                                    class="text-sm font-semibold text-text-main dark:text-gray-200">Primary
                                                    Metric</label>
                                                <select x-model="experiment.metric"
                                                    class="w-full rounded-lg border-border-subtle bg-background-subtle px-4 py-3 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none appearance-none transition-all dark:bg-gray-900 dark:border-gray-600 dark:text-white">
                                                    <option>Conversion Rate</option>
                                                    <option>Click Through Rate</option>
                                                    <option>Revenue Per User</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="bg-white p-8 rounded-xl border border-border-subtle shadow-subtle relative overflow-hidden dark:bg-gray-800 dark:border-gray-700">
                                    <div class="absolute top-0 right-0 p-4 opacity-5 pointer-events-none">
                                        <span
                                            class="material-symbols-outlined text-[120px] text-primary">auto_fix_high</span>
                                    </div>
                                    <div class="flex items-center justify-between mb-4">
                                        <label
                                            class="text-sm font-semibold text-text-main dark:text-gray-200">Hypothesis</label>
                                        <button
                                            class="flex items-center gap-1.5 text-xs font-bold text-primary hover:text-primary-dark transition-colors bg-primary/5 hover:bg-primary/10 px-3 py-1.5 rounded-full dark:bg-primary/20 dark:text-blue-300"
                                            type="button">
                                            <span class="material-symbols-outlined text-[16px]">colors_spark</span> AI
                                            Generate
                                        </button>
                                    </div>
                                    <textarea x-model="experiment.hypothesis"
                                        class="w-full rounded-lg border-border-subtle bg-background-subtle px-4 py-3 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all resize-none dark:bg-gray-900 dark:border-gray-600 dark:text-white"
                                        rows="4"
                                        placeholder="If we change [variable], then [result] will happen..."></textarea>
                                </div>
                            </form>
                        </div>

                        <!-- Step 2 Content: Audience -->
                        <div x-show="step === 2" style="display: none;"
                            class="flex-1 px-6 lg:px-12 py-10 max-w-4xl mx-auto w-full transition-opacity duration-300">
                            <div class="mb-10">
                                <h1
                                    class="text-3xl lg:text-4xl font-bold tracking-tight mb-2 text-text-main dark:text-white">
                                    Configure Audience</h1>
                                <p class="text-text-secondary text-lg dark:text-gray-400">Define who sees your
                                    experiment and how traffic is distributed.</p>
                            </div>
                            <div class="space-y-8">
                                <div
                                    class="bg-white p-8 rounded-xl border border-border-subtle shadow-elegant dark:bg-gray-800 dark:border-gray-700">
                                    <h3 class="text-lg font-bold text-primary-dark dark:text-white mb-6">Audience
                                        Segments</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div
                                            class="p-4 rounded-lg border border-primary bg-primary/5 cursor-pointer dark:bg-primary/20 dark:border-primary/50">
                                            <p class="font-bold text-text-main text-sm dark:text-white">All Visitors</p>
                                            <p class="text-xs text-text-secondary mt-1 dark:text-gray-400">100% of
                                                eligible traffic</p>
                                        </div>
                                        <div
                                            class="p-4 rounded-lg border border-border-subtle hover:border-primary/50 cursor-pointer dark:border-gray-600">
                                            <p class="font-bold text-text-main text-sm dark:text-white">Mobile Only</p>
                                            <p class="text-xs text-text-secondary mt-1 dark:text-gray-400">Smartphone
                                                users</p>
                                        </div>
                                        <div
                                            class="p-4 rounded-lg border border-border-subtle hover:border-primary/50 cursor-pointer dark:border-gray-600">
                                            <p class="font-bold text-text-main text-sm dark:text-white">Custom Rules</p>
                                            <p class="text-xs text-text-secondary mt-1 dark:text-gray-400">Define
                                                specific logic</p>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="bg-white p-8 rounded-xl border border-border-subtle shadow-elegant dark:bg-gray-800 dark:border-gray-700">
                                    <h3 class="text-lg font-bold text-primary-dark dark:text-white mb-6">Traffic
                                        Allocation</h3>
                                    <div class="flex justify-between items-end mb-4">
                                        <label class="text-sm font-bold text-text-main dark:text-gray-200">Total Traffic
                                            Participation</label>
                                        <span class="text-2xl font-bold text-primary"
                                            x-text="experiment.traffic + '%'"></span>
                                    </div>
                                    <input type="range" min="0" max="100" x-model="experiment.traffic"
                                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary dark:bg-gray-700">
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 Content: Variations -->
                        <div x-show="step === 3" style="display: none;"
                            class="flex-1 px-6 lg:px-12 py-10 max-w-5xl mx-auto w-full transition-opacity duration-300">
                            <div class="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4">
                                <div>
                                    <h1
                                        class="text-3xl lg:text-4xl font-bold tracking-tight mb-2 text-text-main dark:text-white">
                                        Manage Variations</h1>
                                    <p class="text-text-secondary text-lg dark:text-gray-400">Define different versions
                                        of your page.</p>
                                </div>
                                <a href="visual_editor_v2.html"
                                    class="bg-white border border-border-subtle hover:border-primary text-text-main hover:text-primary px-4 py-2.5 rounded-lg text-sm font-semibold transition-all shadow-sm flex items-center gap-2 group dark:bg-gray-800 dark:border-gray-600 dark:text-white dark:hover:border-primary dark:hover:text-primary">
                                    <span class="material-symbols-outlined text-[20px]">web</span>
                                    Open Visual Editor
                                </a>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                                <!-- Control Card -->
                                <div
                                    class="group relative flex flex-col rounded-xl border border-border-subtle bg-white shadow-card overflow-hidden dark:bg-gray-800 dark:border-gray-700">
                                    <div
                                        class="relative h-48 w-full bg-slate-50 border-b border-border-subtle flex items-center justify-center dark:bg-gray-900 dark:border-gray-700">
                                        <span
                                            class="text-xs font-bold uppercase tracking-wider text-text-secondary bg-white px-2 py-1 rounded shadow-sm dark:bg-gray-800 dark:text-gray-400">Original
                                            Page</span>
                                    </div>
                                    <div class="p-5 flex flex-col gap-4 flex-1">
                                        <h3 class="text-lg font-bold text-text-main dark:text-white">Control</h3>
                                        <div
                                            class="mt-auto pt-4 border-t border-border-subtle flex items-center justify-between dark:border-gray-700">
                                            <span class="text-sm font-bold text-text-main dark:text-gray-300">50%
                                                Traffic</span>
                                        </div>
                                    </div>
                                </div>
                                <!-- Variant A Card -->
                                <div
                                    class="group relative flex flex-col rounded-xl border border-primary/20 bg-white shadow-card ring-1 ring-primary/5 overflow-hidden dark:bg-gray-800 dark:border-primary/40">
                                    <div
                                        class="relative h-48 w-full bg-slate-50 border-b border-border-subtle flex items-center justify-center dark:bg-gray-900 dark:border-gray-700">
                                        <div
                                            class="absolute -top-2 -right-2 bg-primary text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm flex items-center gap-1">
                                            <span class="material-symbols-outlined text-[12px]">auto_fix_high</span> AI
                                            Generated
                                        </div>
                                        <button
                                            class="bg-white text-text-main hover:text-primary font-semibold text-sm px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 dark:bg-gray-800 dark:text-white">
                                            Preview
                                        </button>
                                    </div>
                                    <div class="p-5 flex flex-col gap-4 flex-1">
                                        <h3 class="text-lg font-bold text-primary">Variant A</h3>
                                        <div
                                            class="mt-auto pt-4 border-t border-border-subtle flex items-center justify-between dark:border-gray-700">
                                            <span class="text-sm font-bold text-text-main dark:text-gray-300">50%
                                                Traffic</span>
                                            <div class="flex gap-2">
                                                <button
                                                    class="p-2 hover:bg-gray-100 rounded text-gray-500 dark:hover:bg-gray-700"><span
                                                        class="material-symbols-outlined">edit</span></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 Content: Review -->
                        <div x-show="step === 4" style="display: none;"
                            class="flex-1 px-6 lg:px-12 py-10 max-w-5xl mx-auto w-full transition-opacity duration-300">
                            <div class="mb-10 flex items-end justify-between">
                                <div>
                                    <h1
                                        class="text-3xl lg:text-4xl font-bold tracking-tight mb-2 text-text-main dark:text-white">
                                        Review & Launch</h1>
                                    <p class="text-text-secondary text-lg dark:text-gray-400">Double check your
                                        experiment configuration.</p>
                                </div>
                                <span
                                    class="hidden md:inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-yellow-50 text-yellow-700 text-xs font-semibold border border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-700">
                                    <span class="size-2 rounded-full bg-yellow-500 animate-pulse"></span> Status: Draft
                                </span>
                            </div>

                            <div class="space-y-8 pb-20">
                                <!-- Overview Summary -->
                                <section
                                    class="bg-white rounded-xl border border-border-subtle shadow-elegant overflow-hidden dark:bg-gray-800 dark:border-gray-700">
                                    <div
                                        class="px-8 py-6 border-b border-border-subtle flex justify-between items-center bg-gray-50/50 dark:bg-gray-700/50 dark:border-gray-600">
                                        <h3
                                            class="text-lg font-bold text-text-main dark:text-white flex items-center gap-2">
                                            <span class="material-symbols-outlined text-primary">info</span> Experiment
                                            Overview
                                        </h3>
                                        <button class="text-primary hover:text-primary-dark text-sm font-medium"
                                            @click="step = 1">Edit</button>
                                    </div>
                                    <div class="p-8 grid grid-cols-1 md:grid-cols-2 gap-y-8 gap-x-12">
                                        <div>
                                            <p
                                                class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-1 dark:text-gray-400">
                                                Name</p>
                                            <p class="text-text-main font-medium dark:text-white"
                                                x-text="experiment.name || 'Untitled Experiment'"></p>
                                        </div>
                                        <div>
                                            <p
                                                class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-1 dark:text-gray-400">
                                                Metric</p>
                                            <p class="text-text-main font-medium dark:text-white"
                                                x-text="experiment.metric"></p>
                                        </div>
                                    </div>
                                </section>

                                <!-- Checklist -->
                                <section
                                    class="bg-white rounded-xl border border-border-subtle shadow-elegant p-6 dark:bg-gray-800 dark:border-gray-700">
                                    <h3
                                        class="text-sm font-bold text-text-secondary uppercase tracking-wider mb-4 dark:text-gray-400">
                                        Pre-launch Checklist</h3>
                                    <div class="space-y-3">
                                        <label class="flex items-start gap-3 group">
                                            <span
                                                class="material-symbols-outlined text-success text-[18px]">check_circle</span>
                                            <div class="text-sm">
                                                <span class="text-text-main font-medium dark:text-white">Tracking code
                                                    installed</span>
                                            </div>
                                        </label>
                                        <label class="flex items-start gap-3 cursor-pointer group">
                                            <input
                                                class="mt-1 rounded border-border-subtle text-primary focus:ring-primary focus:ring-offset-0"
                                                type="checkbox" />
                                            <div class="text-sm">
                                                <span class="text-text-main font-medium dark:text-white">I confirm the
                                                    experiment settings are correct</span>
                                            </div>
                                        </label>
                                    </div>
                                </section>
                            </div>
                        </div>

                        <!-- Sticky Footer -->
                        <div
                            class="sticky bottom-0 z-40 w-full bg-white/90 backdrop-blur-md border-t border-border-subtle px-6 py-4 flex justify-between items-center dark:bg-gray-800/90 dark:border-gray-700">
                            <button x-show="step > 1" @click="step--"
                                class="text-text-secondary hover:text-text-main font-semibold text-sm px-4 py-2 rounded-lg transition-colors flex items-center gap-2 dark:text-gray-400 dark:hover:text-white">
                                <span class="material-symbols-outlined text-[18px]">arrow_back</span> Back
                            </button>
                            <div x-show="step === 1" class="flex-1"></div> <!-- Spacer -->

                            <div class="flex items-center gap-4 ml-auto">
                                <span class="text-xs text-text-secondary hidden sm:inline-block dark:text-gray-500">
                                    <span
                                        class="material-symbols-outlined text-[14px] align-middle mr-1 text-green-600">check_circle</span>
                                    Auto-saved
                                </span>

                                <button x-show="step < 4" @click="step++"
                                    class="bg-primary hover:bg-primary-dark text-white text-sm font-bold px-8 py-2.5 rounded-lg shadow-lg shadow-primary/20 transition-all flex items-center gap-2">
                                    Next <span class="material-symbols-outlined text-[18px]">arrow_forward</span>
                                </button>

                                <button x-show="step === 4" @click="launchExperiment()" :disabled="isSubmitting"
                                    class="bg-green-600 hover:bg-green-700 text-white text-sm font-bold px-8 py-2.5 rounded-lg shadow-lg transition-all flex items-center gap-2 animate-pulse disabled:opacity-50 disabled:cursor-not-allowed">
                                    <span class="material-symbols-outlined text-[20px]"
                                        x-show="!isSubmitting">rocket_launch</span>
                                    <span class="material-symbols-outlined text-[20px] animate-spin"
                                        x-show="isSubmitting">sync</span>
                                    <span x-text="isSubmitting ? 'Launching...' : 'Launch Experiment'"></span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Right Help Sidebar (Only for Step 1 & 2) -->
                    <aside x-show="step <= 2"
                        class="hidden 2xl:block w-80 p-8 border-l border-border-subtle bg-white dark:bg-gray-800 dark:border-gray-700 h-full overflow-y-auto">
                        <div class="sticky top-0">
                            <h3 class="text-sm font-bold text-text-main mb-4 flex items-center gap-2 dark:text-white">
                                <span class="material-symbols-outlined text-primary text-[20px]">lightbulb</span>
                                Sampelit Tips
                            </h3>
                            <div class="space-y-4">
                                <div
                                    class="bg-background-subtle p-4 rounded-lg border border-border-subtle dark:bg-gray-700 dark:border-gray-600">
                                    <p class="text-xs font-semibold text-primary mb-1">PRO TIP</p>
                                    <p class="text-sm text-text-secondary leading-relaxed dark:text-gray-300">Hypotheses
                                        grounded in user research have a <strong>25% higher win rate</strong>.</p>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </main>
        </div>
    </div>
    <script>
        function experimentWizard() {
            return {
                step: 1,
                sidebarToggle: false,
                darkMode: false,
                isSubmitting: false,
                experiment: {
                    name: '',
                    url: 'https://',
                    metric: 'Conversion Rate',
                    hypothesis: '',
                    traffic: 100,
                    variants: [
                        { name: 'Control', type: 'baseline', traffic: 50 },
                        { name: 'Variant A', type: 'variant', traffic: 50 }
                    ]
                },

                init() {
                    this.client = new APIClient();
                    this.darkMode = JSON.parse(localStorage.getItem('darkMode')) || false;
                    this.$watch('darkMode', value => localStorage.setItem('darkMode', JSON.stringify(value)));
                },

                async launchExperiment() {
                    if (this.isSubmitting) return;
                    this.isSubmitting = true;

                    try {
                        const payload = {
                            name: this.experiment.name || 'Untitled Experiment',
                            description: this.experiment.hypothesis,
                            url: this.experiment.url,
                            traffic_allocation: this.experiment.traffic / 100,
                            elements: [{
                                name: "Main Content",
                                selector: { type: "css", selector: "body" },
                                element_type: "generic",
                                original_content: { text: "Original" },
                                variants: this.experiment.variants.slice(1).map(v => ({
                                    text: v.name
                                }))
                            }]
                        };

                        await this.client.post('/experiments', payload);

                        // Show success toast (using dispatch if toast component supports it, otherwise fallback)
                        // For now, redirect
                        window.location.href = 'experiments_v2.html';

                    } catch (error) {
                        console.error('Failed to create experiment:', error);
                        alert('Failed to launch experiment. Please check console.');
                    } finally {
                        this.isSubmitting = false;
                    }
                }
            };
        }
    </script>
</body>

</html>