<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samplit AI Simulator | Watch Intelligence in Action</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link href="https://fonts.googleapis.com/css?family=Inter:300,400,600,700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                fontFamily: { sans: ['Inter', 'sans-serif'] },
                extend: {
                    colors: {
                        brand: {
                            50: '#ecf3ff',
                            100: '#dde9ff',
                            200: '#c2d6ff',
                            300: '#9cb9ff',
                            400: '#7592ff',
                            500: '#465fff',
                            600: '#3641f5',
                            700: '#2a31d8',
                            800: '#252dae',
                            900: '#262e89',
                            950: '#161950',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .grid-bg {
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>

    <!-- âœ… Self-Tracking: Samplit uses Samplit -->
    <script>
        // Minimal tracking stub for the simulator landing
        // In production, this would be the full t.js from CDN
        window.samplit = window.samplit || {
            track: function (event, data) {
                console.log('[Samplit Track]', event, data);
                // POST to our own tracker endpoint
                fetch('/api/v1/tracker/event', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ event, data, timestamp: Date.now() })
                }).catch(() => { });
            }
        };

        // Fire landing_view on load
        document.addEventListener('DOMContentLoaded', () => {
            window.samplit.track('landing_view', { page: 'simulator' });
        });
    </script>
</head>

<body class="bg-slate-50 text-slate-900 overflow-x-hidden" x-data="simulator()">

    <!-- Hero Section -->
    <div class="relative pt-16 pb-12 sm:pt-24 lg:pb-20">
        <div class="mx-auto max-w-7xl px-6 lg:px-8 text-center relative z-10">
            <div
                class="inline-flex items-center rounded-full bg-blue-50 px-3 py-1 text-sm font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 mb-6">
                <span class="flex w-2 h-2 bg-blue-600 rounded-full animate-pulse mr-2"></span>
                Live Intelligence Simulation
            </div>

            <h1 class="text-4xl font-bold tracking-tight text-slate-900 sm:text-6xl mb-6">
                Watch <span class="text-blue-600">Autonomous Selection</span><br>
                <span class="text-slate-400">Outperform the Baseline</span>
            </h1>

            <p class="mt-6 text-lg leading-8 text-slate-600 max-w-2xl mx-auto">
                See how the Samplit Engine identifies high-performing combinations in real-time,
                eliminating waste and concentrating traffic where it converts.
            </p>
        </div>

        <!-- Live Visualizer -->
        <div class="mt-16 bg-white border-y border-slate-200 shadow-sm relative overflow-hidden">
            <div class="mx-auto max-w-7xl px-6 lg:px-8 py-12">

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">

                    <!-- Left: Comparative Traffic Stream -->
                    <div class="lg:col-span-1 space-y-6">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider">Parallel
                                Simulation</h3>
                            <div class="flex gap-2">
                                <span
                                    class="inline-flex items-center rounded bg-slate-100 px-2 py-0.5 text-xs font-medium text-slate-600">Baseline</span>
                                <span
                                    class="inline-flex items-center rounded bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-600">Optimized</span>
                            </div>
                        </div>

                        <!-- Event Log -->
                        <div
                            class="h-96 bg-slate-900 rounded-lg p-4 font-mono text-[10px] text-green-400 overflow-hidden relative border border-slate-800">
                            <div
                                class="absolute inset-x-0 bottom-0 h-24 bg-gradient-to-t from-slate-900 to-transparent pointer-events-none z-10">
                            </div>

                            <template x-for="event in events" :key="event.id">
                                <div class="mb-3 border-b border-slate-800 pb-2 transition-all duration-300"
                                    :class="{'opacity-100': event.new, 'opacity-40': !event.new}">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-slate-500" x-text="event.time"></span>
                                        <span x-show="event.samplit_converted" class="text-blue-400 font-bold">ðŸŽ¯
                                            SAMPLIT HIT</span>
                                    </div>
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <span class="text-slate-500">Base:</span>
                                            <span class="text-slate-300" x-text="event.baseline_choice"></span>
                                            <span x-show="event.baseline_converted"
                                                class="text-yellow-500 ml-1">âœ“</span>
                                        </div>
                                        <div>
                                            <span class="text-blue-500">Opt:</span>
                                            <span class="text-white" x-text="event.samplit_choice"></span>
                                            <span x-show="event.samplit_converted" class="text-blue-400 ml-1">âœ“</span>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Center: Cumulative Growth Chart -->
                    <div class="lg:col-span-2 space-y-8">
                        <div class="bg-white rounded-xl border border-slate-200 p-6 shadow-sm">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-lg font-bold text-slate-900">Conversion Trajectory</h3>
                                    <p class="text-sm text-slate-500">Samplit vs. Random Selection (Simulated 10k Users)
                                    </p>
                                </div>
                                <div class="text-right">
                                    <span class="block text-2xl font-bold text-blue-600"
                                        x-text="'+' + improvement"></span>
                                    <span class="text-xs text-slate-400">Revenue Lift</span>
                                </div>
                            </div>

                            <div id="chart" class="h-64 w-full"></div>

                            <div class="grid grid-cols-3 gap-6 mt-8 pt-6 border-t border-slate-100">
                                <div>
                                    <dt class="text-xs font-medium text-slate-500 uppercase">Extra Conversions</dt>
                                    <dd class="mt-1 text-xl font-bold text-slate-900" x-text="extraConversions"></dd>
                                </div>
                                <div>
                                    <dt class="text-xs font-medium text-slate-500 uppercase">Baseline CR</dt>
                                    <dd class="mt-1 text-xl font-bold text-slate-500" x-text="baselineCR"></dd>
                                </div>
                                <div>
                                    <dt class="text-xs font-medium text-slate-500 uppercase">Optimized CR</dt>
                                    <dd class="mt-1 text-xl font-bold text-blue-600" x-text="samplitCR"></dd>
                                </div>
                            </div>
                        </div>

                        <!-- Top Performing Variants List -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <template x-for="(variant, index) in topVariants" :key="variant.key">
                                <div
                                    class="bg-slate-50 rounded-lg p-4 border border-slate-200 flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs font-bold text-slate-400"
                                            x-text="index + 1"></div>
                                        <span class="text-sm font-medium text-slate-700" x-text="variant.key"></span>
                                    </div>
                                    <div class="text-right">
                                        <span class="block text-sm font-bold text-slate-900"
                                            x-text="(variant.cr * 100).toFixed(1) + '%'"></span>
                                        <span class="text-[10px] text-slate-400 uppercase">Conv. Rate</span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- CTA Section -->
        <div class="mx-auto max-w-7xl px-6 lg:px-8 py-20 text-center">
            <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">
                Ready to outpace your baseline?
            </h2>
            <p class="mt-4 text-lg text-slate-600 mb-8 max-w-2xl mx-auto">
                Join our private beta to deploy autonomous optimization on your own site.
                Simple integration. Measurable mathematical lift.
            </p>

            <form class="max-w-md mx-auto flex gap-x-4" @submit.prevent="submitEmail">
                <label for="email-address" class="sr-only">Email address</label>
                <input id="email-address" name="email" type="email" autocomplete="email" required x-model="email"
                    class="min-w-0 flex-auto rounded-md border-0 px-3.5 py-2 text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"
                    placeholder="Enter your email">
                <button type="submit" :disabled="submitting"
                    class="flex-none rounded-md bg-slate-900 px-3.5 py-2.5 text-sm font-medium text-white shadow-sm hover:bg-slate-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900 disabled:opacity-50">
                    <span x-show="!submitting">Get Early Access</span>
                    <span x-show="submitting">Loading...</span>
                </button>
            </form>
            <p x-show="submitted" class="mt-4 text-slate-600 font-medium" x-transition>Verification link sent. Technical
                team will reach out soon.</p>
        </div>
    </div>

    <script>
        function simulator() {
            return {
                events: [],
                stats: { visitors: 0, samplit_conv: 0, baseline_conv: 0 },
                variant_details: [],
                submitted: false,
                submitting: false,
                email: '',
                improvement: '0%',
                extraConversions: '0',
                baselineCR: '0.0%',
                samplitCR: '0.0%',
                chart: null,

                async init() {
                    this.initChart();
                    // 1. Load initial 10k visualization state
                    await this.loadSummary();
                    // 2. Continue simulation (optional, adds life to page)
                    this.startSimulation();
                },

                initChart() {
                    const options = {
                        series: [{
                            name: 'Samplit Optimized',
                            data: []
                        }, {
                            name: 'Random Baseline',
                            data: []
                        }],
                        chart: {
                            type: 'area',
                            height: 250,
                            toolbar: { show: false },
                            sparkline: { enabled: false },
                        },
                        colors: ['#3641f5', '#94a3b8'],
                        dataLabels: { enabled: false },
                        stroke: { curve: 'smooth', width: 2 },
                        fill: {
                            type: 'gradient',
                            gradient: {
                                shadeIntensity: 1,
                                opacityFrom: 0.45,
                                opacityTo: 0.05,
                                stops: [20, 100]
                            }
                        },
                        xaxis: {
                            categories: Array.from({ length: 10 }, (_, i) => (i + 1) * 1000),
                            labels: {
                                style: { colors: '#94a3b8', fontSize: '10px' },
                                formatter: val => val >= 1000 ? (val / 1000) + 'k' : val
                            }
                        },
                        yaxis: {
                            labels: {
                                style: { colors: '#94a3b8', fontSize: '10px' }
                            }
                        },
                        grid: { borderColor: '#f1f5f9' },
                        legend: { position: 'top', horizontalAlign: 'right' }
                    };

                    this.chart = new ApexCharts(document.querySelector("#chart"), options);
                    this.chart.render();
                },

                async loadSummary() {
                    try {
                        const res = await fetch('/api/v1/simulate/summary');
                        const data = await res.json();

                        this.stats.visitors = data.total_visitors;
                        this.improvement = data.performance_gap.uplift + '%';
                        this.extraConversions = data.performance_gap.extra_conversions;
                        this.baselineCR = (data.strategies.baseline.conversion_rate * 100).toFixed(1) + '%';
                        this.samplitCR = (data.strategies.samplit.conversion_rate * 100).toFixed(1) + '%';
                        this.variant_details = data.variant_details;

                        // Mock cumulative data for the chart based on the summary
                        const samplitData = [];
                        const baselineData = [];
                        let s_acc = 0;
                        let b_acc = 0;

                        const s_step = data.strategies.samplit.conversions / 10;
                        const b_step = data.strategies.baseline.conversions / 10;

                        for (let i = 0; i < 10; i++) {
                            s_acc += s_step + (Math.random() * 20 - 10);
                            b_acc += b_step + (Math.random() * 20 - 10);
                            samplitData.push(Math.floor(s_acc));
                            baselineData.push(Math.floor(b_acc));
                        }

                        this.chart.updateSeries([
                            { name: 'Samplit Optimized', data: samplitData },
                            { name: 'Random Baseline', data: baselineData }
                        ]);

                    } catch (e) { console.error("Summary load failed", e); }
                },

                async startSimulation() {
                    setInterval(async () => {
                        const res = await fetch('/api/v1/simulate/stream');
                        const data = await res.json();

                        data.batch.forEach((e, i) => {
                            setTimeout(() => {
                                this.addEvent(e);
                            }, i * 200); // Stagger events for realism
                        });

                    }, 4000);
                },

                addEvent(e) {
                    const now = new Date();
                    const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });

                    this.events.unshift({
                        id: Math.random(),
                        time: time,
                        samplit_choice: e.samplit_choice,
                        baseline_choice: e.baseline_choice,
                        samplit_converted: e.samplit_converted,
                        baseline_converted: e.baseline_converted,
                        new: true
                    });

                    if (this.events.length > 15) this.events.pop();

                    setTimeout(() => {
                        if (this.events[0]) this.events[0].new = false;
                    }, 500);
                },

                get topVariants() {
                    return this.variant_details.slice(0, 4);
                },

                submitEmail() {
                    this.submitting = true;
                    fetch('/api/v1/leads/capture', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            email: this.email,
                            source: 'simulator_v2'
                        })
                    })
                        .then(res => res.json())
                        .then(data => {
                            this.submitted = true;
                            this.submitting = false;
                            if (window.samplit && window.samplit.track) {
                                window.samplit.track('lead_gen', { page: 'simulator' });
                            }
                        })
                        .catch(err => {
                            console.error("Lead capture failed", err);
                            this.submitting = false;
                        });
                }
            }
        }
    </script>
</body>

</html>