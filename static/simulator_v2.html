<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sampelit | Simulator</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Manrope:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1" />

    <!-- Core Design System: Tailwind CDN + Style Standard -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
    <link rel="stylesheet" href="css/sampelit-v2.css" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: "#0f172a",   // Navy Sampelit
                        accent: "#1e3a8a",    // Blue Accent Premium
                        sampelit: "#0f172a"   // Alias primary
                    },
                    fontFamily: {
                        display: ['Manrope', 'sans-serif'],
                        body: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'premium': '0 10px 30px -5px rgba(15, 23, 42, 0.08)',
                        'soft': '0 2px 10px rgba(0, 0, 0, 0.03)'
                    }
                }
            }
        }
    </script>

    <style>
        [x-cloak] {
            display: none !important;
        }
    </style>

    <!-- Essential Scripts -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="js/include.js"></script>
    <script src="js/core/api.js"></script>
</head>

<body x-data="simulator"
    class="bg-[#f8f9fc] dark:bg-gray-900 text-text-main dark:text-gray-300 font-sans antialiased selection:bg-primary/10 selection:text-primary">

    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <include src="./partials/sidebar_v2.html"></include>

        <!-- Content Area -->
        <div
            class="relative flex flex-1 flex-col overflow-y-auto overflow-x-hidden bg-surface dark:bg-gray-900 transition-colors duration-300">
            <!-- Header -->
            <include src="./partials/header_v2.html"></include>

            <!-- Main Content -->
            <main>
                <div class="mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10">

                    <!-- Title -->
                    <div class="mb-8 flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
                        <div>
                            <h2 class="text-3xl font-extrabold tracking-premium-tight text-gray-900 dark:text-white">
                                Algorithm Simulator
                            </h2>
                            <p class="mt-1 text-sm text-gray-500 font-medium tracking-premium">Configure statistical
                                parameters to forecast A/B test convergence.</p>
                        </div>
                        <div class="flex items-center gap-3">
                            <button
                                class="px-4 py-2 text-sm font-bold text-gray-600 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 flex items-center gap-2 shadow-sm dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300">
                                <span class="material-symbols-outlined text-[18px]">upload</span>
                                Load Preset
                            </button>
                            <button
                                class="px-4 py-2 text-sm font-bold text-gray-600 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 flex items-center gap-2 shadow-sm dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300">
                                <span class="material-symbols-outlined text-[18px]">download</span>
                                Export Report
                            </button>
                        </div>
                    </div>

                    <!-- Simulator Workspace -->
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">

                        <!-- Left Column: Configuration -->
                        <div class="lg:col-span-4 flex flex-col gap-6">
                            <div
                                class="bg-white rounded-[24px] border border-gray-100 shadow-soft overflow-hidden dark:bg-gray-800 dark:border-gray-700">
                                <div
                                    class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 dark:bg-white/5 dark:border-gray-700">
                                    <h3 class="font-bold text-gray-900 flex items-center gap-2 dark:text-white">
                                        <span class="material-symbols-outlined text-primary text-[20px]">tune</span>
                                        Configuration
                                    </h3>
                                    <span class="text-xs font-black text-gray-400 uppercase tracking-widest">v2.4</span>
                                </div>

                                <div class="flex flex-col divide-y divide-gray-100 dark:divide-gray-700">
                                    <!-- Traffic Allocation -->
                                    <div class="p-5">
                                        <div class="flex items-center justify-between mb-4">
                                            <span class="text-sm font-bold text-gray-800 dark:text-gray-200">Total Daily
                                                Traffic</span>
                                        </div>
                                        <div class="space-y-6">
                                            <div>
                                                <div class="flex justify-between text-xs mb-2">
                                                    <span class="text-gray-500">Traffic Volume</span>
                                                    <span class="font-bold text-gray-900 dark:text-white"
                                                        x-text="config.traffic + ' visitors'"></span>
                                                </div>
                                                <input x-model="config.traffic" @input.debounce.500ms="runSimulation()"
                                                    class="w-full accent-primary h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"
                                                    type="range" min="100" max="50000" step="100">
                                                <div class="flex justify-between text-xs mt-1 text-gray-400">
                                                    <span>100</span>
                                                    <span>50k</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Statistical Parameters -->
                                    <div class="p-5">
                                        <div class="flex items-center justify-between mb-4">
                                            <span
                                                class="text-sm font-bold text-gray-800 dark:text-gray-200">Parameters</span>
                                        </div>
                                        <div class="space-y-4">
                                            <div class="grid grid-cols-2 gap-4">
                                                <div class="space-y-1.5">
                                                    <label class="text-xs font-bold text-gray-500">Confidence</label>
                                                    <select x-model="config.confidence" @change="runSimulation()"
                                                        class="w-full text-sm border-gray-200 rounded-lg focus:border-primary focus:ring-primary/20 bg-gray-50 py-2 font-medium text-gray-700 appearance-none dark:bg-gray-900 dark:border-gray-600 dark:text-gray-300">
                                                        <option value="90">90%</option>
                                                        <option value="95">95%</option>
                                                        <option value="99">99%</option>
                                                    </select>
                                                </div>
                                                <div class="space-y-1.5">
                                                    <label class="text-xs font-bold text-gray-500">Uplift</label>
                                                    <select x-model="config.uplift" @change="runSimulation()"
                                                        class="w-full text-sm border-gray-200 rounded-lg focus:border-primary focus:ring-primary/20 bg-gray-50 py-2 font-medium text-gray-700 appearance-none dark:bg-gray-900 dark:border-gray-600 dark:text-gray-300">
                                                        <option value="5">5%</option>
                                                        <option value="10">10%</option>
                                                        <option value="20">20%</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div
                                    class="p-5 bg-gray-50/50 border-t border-gray-100 dark:bg-white/5 dark:border-gray-700">
                                    <button @click="runSimulation()" :disabled="loading"
                                        class="w-full bg-primary hover:bg-primary-dark text-white font-bold py-3 px-4 rounded-xl shadow-lg shadow-primary/20 transition-all flex items-center justify-center gap-2 active:scale-[0.98] disabled:opacity-50">
                                        <span class="material-symbols-outlined text-[20px]"
                                            x-text="loading ? 'sync' : 'play_arrow'"></span>
                                        <span x-text="loading ? 'Simulating...' : 'Run Simulation'"></span>
                                    </button>
                                    <p
                                        class="text-xs text-center text-gray-400 mt-3 flex items-center justify-center gap-1">
                                        <span class="material-symbols-outlined text-[14px]">info</span>
                                        Est. computation time: ~1.2s
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Results -->
                        <div class="lg:col-span-8 flex flex-col gap-6">
                            <!-- KPI Cards -->
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                                <!-- Card 1 -->
                                <div
                                    class="bg-white p-6 rounded-[24px] border border-gray-100 shadow-soft dark:bg-gray-800 dark:border-gray-700">
                                    <div class="flex items-start justify-between mb-2">
                                        <p class="text-[10px] font-black uppercase tracking-widest text-gray-400">Sample
                                            Size</p>
                                        <span class="material-symbols-outlined text-gray-300 text-[20px]">groups</span>
                                    </div>
                                    <p class="text-3xl font-bold text-gray-900 tracking-tight dark:text-white">24,500
                                    </p>
                                    <p class="text-xs text-secondary mt-1">Visitors per variation</p>
                                </div>
                                <!-- Card 2 -->
                                <div
                                    class="bg-white p-6 rounded-[24px] border border-gray-100 shadow-soft dark:bg-gray-800 dark:border-gray-700">
                                    <div class="flex items-start justify-between mb-2">
                                        <p class="text-[10px] font-black uppercase tracking-widest text-gray-400">
                                            Duration</p>
                                        <span class="material-symbols-outlined text-gray-300 text-[20px]">timer</span>
                                    </div>
                                    <p class="text-3xl font-bold text-gray-900 tracking-tight dark:text-white">14 <span
                                            class="text-lg font-normal text-gray-400">days</span></p>
                                    <p class="text-xs text-emerald-600 font-bold mt-1 flex items-center gap-1">
                                        <span class="material-symbols-outlined text-[14px]">trending_down</span>
                                        -2 days vs avg
                                    </p>
                                </div>
                                <!-- Card 3 -->
                                <div
                                    class="bg-white p-6 rounded-[24px] border border-gray-100 shadow-soft dark:bg-gray-800 dark:border-gray-700">
                                    <div class="flex items-start justify-between mb-2">
                                        <p class="text-[10px] font-black uppercase tracking-widest text-gray-400">Req.
                                            Uplift</p>
                                        <span
                                            class="material-symbols-outlined text-gray-300 text-[20px]">trending_up</span>
                                    </div>
                                    <p class="text-3xl font-bold text-primary tracking-tight">+5.2%</p>
                                    <p class="text-xs text-secondary mt-1">To reach 95% sig.</p>
                                </div>
                            </div>

                            <!-- Main Chart -->
                            <div
                                class="bg-white rounded-[24px] border border-gray-100 shadow-soft p-6 md:p-8 dark:bg-gray-800 dark:border-gray-700">
                                <div class="flex items-center justify-between mb-8">
                                    <div>
                                        <h3 class="font-bold text-lg text-gray-900 dark:text-white">Convergence
                                            Projection</h3>
                                        <p class="text-sm text-gray-500 font-medium">Projected p-value evolution over
                                            traffic volume.</p>
                                    </div>
                                </div>
                                <!-- Placeholder for ApexCharts or SVG -->
                                <div id="convergenceChart"
                                    class="h-[350px] w-full flex items-center justify-center bg-gray-50 rounded-xl dark:bg-gray-900">
                                    <!-- We will init chart here -->
                                    <p class="text-gray-400 font-medium animate-pulse">Initializing Visualization...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <!-- Chart Init -->
    <script src="js/pages/simulator_v2.js"></script>
</body>

</html>