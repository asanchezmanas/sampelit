<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="page-title">Blog Post | Samplit</title>

    <!-- Meta tags (populated dynamically) -->
    <meta name="description" id="meta-description" content="">
    <meta name="keywords" id="meta-keywords" content="">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700&display=swap" rel="stylesheet">

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                fontFamily: { sans: ['Inter', 'sans-serif'] },
                extend: {
                    colors: {
                        brand: { 50: '#ecf3ff', 500: '#465fff', 600: '#3641f5' }
                    }
                }
            }
        }
    </script>

    <!-- Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        [x-cloak] {
            display: none !important;
        }

        /* Markdown Content Styling */
        .prose {
            max-width: 65ch;
            color: #374151;
        }

        .prose h1 {
            font-size: 2.25rem;
            font-weight: 800;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #111827;
        }

        .prose h2 {
            font-size: 1.875rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #111827;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }

        .prose h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #111827;
        }

        .prose p {
            margin-bottom: 1.25rem;
            line-height: 1.75;
        }

        .prose ul,
        .prose ol {
            margin-bottom: 1.25rem;
            padding-left: 1.5rem;
        }

        .prose li {
            margin-bottom: 0.5rem;
        }

        .prose a {
            color: #465fff;
            text-decoration: underline;
        }

        .prose a:hover {
            color: #3641f5;
        }

        .prose code {
            background: #f3f4f6;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }

        .prose pre {
            background: #1f2937;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1.25rem;
        }

        .prose pre code {
            background: transparent;
            padding: 0;
            color: #e5e7eb;
        }

        .prose blockquote {
            border-left: 4px solid #465fff;
            padding-left: 1rem;
            font-style: italic;
            color: #6b7280;
            margin: 1.5rem 0;
        }

        .prose table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .prose th,
        .prose td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
        }

        .prose th {
            background: #f9fafb;
            font-weight: 600;
        }

        .prose img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
        }

        /* Dark mode */
        .dark .prose {
            color: #d1d5db;
        }

        .dark .prose h1,
        .dark .prose h2,
        .dark .prose h3 {
            color: #f9fafb;
        }

        .dark .prose h2 {
            border-bottom-color: #374151;
        }

        .dark .prose code {
            background: #374151;
            color: #e5e7eb;
        }

        .dark .prose blockquote {
            color: #9ca3af;
        }

        .dark .prose th {
            background: #374151;
        }

        .dark .prose th,
        .dark .prose td {
            border-color: #4b5563;
        }
    </style>
</head>

<body x-data="blogPost()" x-init="init()">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <include src="./partials/sidebar.html"></include>

        <!-- Content -->
        <div class="relative flex flex-1 flex-col overflow-y-auto overflow-x-hidden">
            <!-- Header -->
            <include src="./partials/header.html"></include>

            <!-- Main -->
            <main>
                <div class="mx-auto max-w-4xl p-4 md:p-6 pb-20">

                    <!-- Loading State -->
                    <div x-show="loading" class="flex justify-center py-12">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"></div>
                    </div>

                    <!-- Article -->
                    <article x-show="!loading"
                        class="bg-white rounded-lg border border-gray-200 p-8 md:p-12 dark:bg-gray-800 dark:border-gray-700">
                        <!-- Back Link -->
                        <a href="/static/blog.html"
                            class="inline-flex items-center text-sm text-gray-600 hover:text-brand-600 mb-6 dark:text-gray-400">
                            ← Back to blog
                        </a>

                        <!-- Category Badge -->
                        <span
                            class="inline-block px-3 py-1 text-xs font-medium rounded bg-brand-50 text-brand-600 mb-4 dark:bg-brand-900/30 dark:text-brand-400"
                            x-text="getCategoryLabel(metadata.category)"></span>

                        <!-- Title -->
                        <h1 class="text-4xl font-bold text-gray-900 mb-4 dark:text-white" x-text="metadata.title"></h1>

                        <!-- Meta -->
                        <div class="flex items-center gap-4 text-sm text-gray-600 mb-8 dark:text-gray-400">
                            <span x-text="metadata.author"></span>
                            <span>•</span>
                            <span x-text="formatDate(metadata.date)"></span>
                            <span x-show="metadata.reading_time">•</span>
                            <span x-show="metadata.reading_time" x-text="metadata.reading_time + ' min read'"></span>
                        </div>

                        <!-- Content -->
                        <div class="prose dark:prose-invert" x-html="content"></div>

                        <!-- Share -->
                        <div class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
                            <p class="text-sm text-gray-600 mb-3 dark:text-gray-400">Share this article:</p>
                            <div class="flex gap-3">
                                <a :href="'https://twitter.com/intent/tweet?text=' + encodeURIComponent(metadata.title) + '&url=' + encodeURIComponent(window.location.href)"
                                    target="_blank"
                                    class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm hover:bg-gray-200 transition-colors dark:bg-gray-700 dark:text-gray-300">
                                    Twitter
                                </a>
                                <a :href="'https://www.linkedin.com/sharing/share-offsite/?url=' + encodeURIComponent(window.location.href)"
                                    target="_blank"
                                    class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm hover:bg-gray-200 transition-colors dark:bg-gray-700 dark:text-gray-300">
                                    LinkedIn
                                </a>
                            </div>
                        </div>
                    </article>

                    <!-- CTA -->
                    <div x-show="!loading"
                        class="mt-8 bg-gradient-to-r from-brand-500 to-brand-600 rounded-lg p-8 text-center text-white">
                        <h3 class="text-2xl font-bold mb-2">Ready to test your own copy?</h3>
                        <p class="mb-6 opacity-90">Start running experiments in minutes with Samplit.</p>
                        <a href="/static/visual-editor.html"
                            class="inline-block px-6 py-3 bg-white text-brand-600 font-semibold rounded-lg hover:bg-gray-100 transition-colors">
                            Try the Visual Editor
                        </a>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <!-- Scripts -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="./js/include.js"></script>

    <script>
        function blogPost() {
            return {
                metadata: {},
                content: '',
                loading: false,

                async init() {
                    const params = new URLSearchParams(window.location.search);
                    const slug = params.get('slug');

                    if (!slug) {
                        window.location.href = '/static/blog.html';
                        return;
                    }

                    await this.loadPost(slug);
                },

                async loadPost(slug) {
                    this.loading = true;
                    try {
                        const response = await fetch(`/api/v1/blog/${slug}`);
                        if (!response.ok) throw new Error('Post not found');

                        const data = await response.json();
                        this.metadata = data.metadata;
                        this.content = data.content;

                        // Update page title and meta tags
                        document.getElementById('page-title').textContent = `${this.metadata.title} | Samplit Blog`;
                        document.getElementById('meta-description').setAttribute('content', this.metadata.excerpt);
                        document.getElementById('meta-keywords').setAttribute('content', this.metadata.keywords.join(', '));

                        // Highlight code blocks
                        this.$nextTick(() => {
                            document.querySelectorAll('pre code').forEach((block) => {
                                hljs.highlightElement(block);
                            });
                        });

                    } catch (error) {
                        console.error('Failed to load blog post:', error);
                        alert('Article not found');
                        window.location.href = '/static/blog.html';
                    } finally {
                        this.loading = false;
                    }
                },

                getCategoryLabel(category) {
                    const labels = {
                        'ab-testing-fundamentals': 'Fundamentals',
                        'case-studies': 'Case Study',
                        'copywriting-science': 'Science'
                    };
                    return labels[category] || category;
                },

                formatDate(dateStr) {
                    const date = new Date(dateStr);
                    return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                }
            }
        }
    </script>
</body>

</html>